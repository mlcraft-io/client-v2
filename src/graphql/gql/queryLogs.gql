fragment DefaultFields on request_logs {
  id
  created_at
  updated_at
  request_id
  start_time
  end_time
  duration
  path
  user {
    display_name
  }
  datasource {
    name
  }
}

query CurrentLog($id: uuid!) {
  request_logs_by_pk(id: $id) {
    ...DefaultFields
    request_event_logs(order_by: { timestamp: desc }) {
      id
      duration
      event
      path
      query
      query_key
      query_sql
      query_key_md5
      queue_prefix
      time_in_queue
      timestamp
      error
    }
  }
}

query AllLogs(
  $offset: Int
  $limit: Int
  $where: request_logs_bool_exp
  $order_by: [request_logs_order_by!]
) {
  request_logs(
    offset: $offset
    limit: $limit
    where: $where
    order_by: $order_by
  ) {
    ...DefaultFields
    request_event_logs(order_by: { timestamp: desc }) {
      path
      error
    }
    request_event_logs_aggregate {
      aggregate {
        count
      }
    }
  }
  request_logs_aggregate(where: $where) {
    aggregate {
      count
    }
  }
}

subscription SubAllLogs(
  $offset: Int
  $limit: Int
  $where: request_logs_bool_exp
  $order_by: [request_logs_order_by!]
) {
  request_logs(
    offset: $offset
    limit: $limit
    where: $where
    order_by: $order_by
  ) {
    id
  }
}
